<%= render "layouts/nav" %>

<% if notice!=nil %>
<div class="column is-12 ">
    <div class="notification is-warning">
      <button class="delete"></button>
      <%= notice %>
    </div>
</div>
<% end %>

<% if policy(@transactions).new? %>
  <div class="column is-12 ">
    <div class="box cta">
      <div class="columns is-mobile is-centered">
          <div class="field is-grouped is-grouped-multiline">
            <div class="control">
              <%= link_to new_transaction_path ,class: "button is-link is-medium" do%>
                <span class="icon"><i class="fa fa-plus" aria-hidden="true"></i></span><span></span>Screening</a>
              <% end %>
            </div>
          </div>
      </div>
    </div>
  </div>
<% end %>
<div class="column is-12 ">    
  <% @transactions.each do |transaction| %>    
    <div class="box cta">
      <div class="card-content">
        <div class="media">
          <div class="media-content">
            <p class="title is-4"><%= transaction.name %>
              <% if transaction.gender=="Male" || transaction.gender=="Male" %>
                <span class="icon"><i class="fa fa-mars" aria-hidden="true"></i></span> <small><%= transaction.age%> y.o</small>
              <% else %>
                <span class="icon"><i class="fa fa-venus" aria-hidden="true"></i></span> <small><%= transaction.age%> y.o</small>
              <% end %>
            </p>
            <p class="subtitle is-6"><span class="icon"><i class="fa fa-file-o" aria-hidden="true"></i></span><%= transaction.medic_record_number %> / <span class="icon"><i class="fa fa-sign-in" aria-hidden="true"></i></span> <%= transaction.ruangan %> / <span class="icon"><i class="fa fa-bed" aria-hidden="true"></i></span> <%= transaction.bed_number %><br> <span class="icon"><i class="fa fa-clock-o" aria-hidden="true"></i></span><%= transaction.created_at.strftime("%H:%M:%S") %><span class="icon"><i class="fa fa-calendar" aria-hidden="true"></i></span><%= transaction.created_at.strftime("%d/%b/%Y") %></p>
          </div>
        </div>
        <hr>
        <div class="content">
          <% @decision = Decision.where(["begin_value <= ?",transaction.score]).where(["end_value >= ?", transaction.score]).first %>
          <span class="subtitle is-4 has-text-link"><%= @decision.title %></span><br>
            <%= @decision.decision.html_safe %>
          <br>
          <span class="icon"><i class="fa fa-user-md" aria-hidden="true"></i></span><%= transaction.doctor %>
        </div>
      </div>

      <footer class="card-footer">
        <div class="card-footer-item">
          <div class="columns">
            <div class="column is-12">
              <div class="buttons is-left">
                <% if policy(transaction).export_pdf? %>
                  <%= link_to export_pdf_transaction_path( transaction, :format => :pdf), class: "button is-danger" do %>
                    <span class="icon"><i class="fa fa-file-pdf-o" aria-hidden="true"></i></span><span></span> Export
                  <% end %>
                <% end %>
                <% if policy(transaction).destroy? %>
                  <%= link_to 'Destroy', transaction, method: :delete,class: "button is-warning", data: { confirm: 'Are you sure?' } %>
                <% end %>
                <% if policy(transaction).show? %>
                  <%= link_to 'Show', transaction,class: "button is-primary" %>

                <% end %>
              </div>
            </div>
            
          </div>
            
        </div>
      </footer>

    </div>
  <% end %>

  <%= will_paginate @posts, renderer: BulmaPagination::Rails,
      :class => 'pagination is-centered is-rounded',
      :previous_label => 'Previous',
      :next_label => 'Next page' %>

</div>

